<div class="rowinv row">
<div class="formDiv panel">
  <h2 class="col-12">Calculator investitii</h2>
<form class="forminv">
  <label for="startingBal">SUMA INIȚIALĂ</label>
  <input type="number" class="form-control" id="startingBal"/>
  <label for="expectedReturn"> RATA DE CREȘTERE ANUALĂ(%)</label>
  <input type="number" class="form-control" id="expectedReturn"/>
  <label for="monthlyDep">CONTRIBUȚIA LUNARĂ</label>
  <input type="number" class="form-control" id="monthlyDep"/>
  <label for="duration">DURATA (ANI)</label>
  <input type="number" class="form-control" id="duration"/>
	<div class="row">
	<div class="col-6" style="display: flex; align-content: center; flex-wrap: wrap;">
  <button type="submit" class="btn btn-primary" id="submitinv">CALCULEAZA</button>
	</div>
	<div class="col-6">
		<label id="finalValue"></label>
	</div>
	</div>
</form>
</div>
 
</div>

<style>

label, input, h1, button {
  display: block;
}
input {
  margin-bottom: 10px;
  font-size: 20px;
}
table {
  display: none;
}

.invh1 {
  text-align: center;
  border-bottom: 1px lightgrey solid;
  margin: 0px;
  padding: 10px 0px;
  box-shadow: 0px 1px 1px 0px lightgrey;
  background-color: white;
}
#myChart {
  display: none;
}
.rowinv {
 max-height: 90vh !important; 
}
.panel {
  background-color: white;
  border-radius: 2px;
  box-shadow: 0px 0px 5px 2px lightgrey;
  padding: 20px;
  margin: 5px;
	margin-bottom: 15px;
}
</style>

<script>
// Create event listener on submit button
document.getElementById("submitinv").addEventListener("click", (e) => calculate(e))

// Function to make calculations and build table
function calculate(e) {
  e.preventDefault();
  let labels = [];
  let balances = [];
  // Take form input and assign them to variables 
  const formItems = document.querySelector("form").children;
  let startingBal = parseInt(formItems[1].value);
  const expReturn = parseInt(formItems[3].value)/100;
  const monthlyDep = parseInt(formItems[5].value);
  const duration = parseInt(formItems[7].value);
  const monthlyReturn = expReturn/12;
  
  if(!startingBal || !expReturn || !monthlyDep || !duration) {
    return;
  }
  
  // Create formatter for USD
  const formatter = new Intl.NumberFormat('ro-RO', {
  style: 'currency',
  currency: 'RON',
  minimumFractionDigits: 2
  })
  
  // Loop through items to update starting balance and build out table rows
  for(let i = 1; i <= duration*12; i++) {
    startingBal = (startingBal * (1 + monthlyReturn)) + monthlyDep;
    if(i % 12 === 0) {
      const year = i/12;
      balances.push(startingBal.toFixed(2));
      labels.push(`Year ${year}`);
    }
  }
  
  // Make table and chart appear and have the total presented at the bottom of the screen
  if(document.querySelector("#finalValue")) {
    document.querySelector("#finalValue").innerHTML = `Total după ${duration} ani: ` + formatter.format(startingBal);
  } else {
    const finalValue = document.createElement("h3");
    finalValue.setAttribute("id", "finalValue");
    finalValue.innerHTML = `Total după ${duration} ani: ` + formatter.format(startingBal);
    document.querySelector(".chartDiv").appendChild(finalValue);
  }
  document.getElementById("submitinv").innerHTML = "Re-Calculează"
}

</script>